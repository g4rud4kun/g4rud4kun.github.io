
  <!DOCTYPE html>
  <html lang="en"  data-theme="dark" >
  <head>
  <meta charset="utf-8">
  

  

  

  <script>window.REIMU_CONFIG = {};window.REIMU_CONFIG.icon_font = '4552607_bq08450reo';window.REIMU_CONFIG.clipboard_tips = {"success":"Copy Successful","fail":"Copy Failed","copyright":{"enable":false,"count":50,"content":"本文版权：本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！"}};window.REIMU_CONFIG.code_block = {"expand":true};</script>
  
  <title>
    NahamCon CTF 2025 |
    
    g4rud4kun
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link rel="preload" as="style" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic%7CSource%20Code%20Pro:400,400italic,700,700italic&display=swap"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic%7CSource%20Code%20Pro:400,400italic,700,700italic&display=swap" media="print" onload="this.media&#x3D;&#39;all&#39;">
  
    <link rel="preload" href="//at.alicdn.com/t/c/font_4552607_bq08450reo.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  
  
    
<link rel="stylesheet" href="/css/loader.css">

  
  
    <meta name="description" content="I participated in NahamCon CTF 2025, organized by JohnHammond, as a member of my institute’s club, InfoSecIITR. This writeup details the challenge I solved during the competition. NetworkingA Special">
<meta property="og:type" content="article">
<meta property="og:title" content="NahamCon CTF 2025">
<meta property="og:url" content="https://g4rud4kun.github.io/2025/05/28/NahamCon-CTF-2025/index.html">
<meta property="og:site_name" content="g4rud4kun">
<meta property="og:description" content="I participated in NahamCon CTF 2025, organized by JohnHammond, as a member of my institute’s club, InfoSecIITR. This writeup details the challenge I solved during the competition. NetworkingA Special">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://g4rud4kun.github.io/images/posts/2025-nahamcon/nahamcon.jpg">
<meta property="article:published_time" content="2025-05-28T12:26:18.000Z">
<meta property="article:modified_time" content="2025-06-03T13:26:00.615Z">
<meta property="article:author" content="Harsh">
<meta property="article:tag" content="networking">
<meta property="article:tag" content="forensics">
<meta property="article:tag" content="scapy">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://g4rud4kun.github.io/images/posts/2025-nahamcon/nahamcon.jpg">
  
  
    <link rel="alternate" href="/atom.xml" title="g4rud4kun" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/images/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  <link rel="preload" href="https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  
    
      
        
<link rel="stylesheet" href="https://npm.webcache.cn/katex@0.16.11/dist/katex.min.css">

      
    
  
  
  
  
    
<script src="https://npm.webcache.cn/pace-js@1.2.4/pace.min.js" integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous"></script>

  
  
    
<link rel="stylesheet" href="https://npm.webcache.cn/@reimujs/aos@0.1.0/dist/aos.css">

  
  
<meta name="generator" content="Hexo 7.3.0"></head>

  <body>
    
  <div id='loader'>
    <div class="loading-left-bg loading-bg"></div>
    <div class="loading-right-bg loading-bg"></div>
    <div class="spinner-box">
      <div class="loading-taichi">
        
          <svg width="150" height="150" viewBox="0 0 1024 1024" class="icon" version="1.1" xmlns="https://www.w3.org/2000/svg" shape-rendering="geometricPrecision">
            <path d="M303.5 432A80 80 0 0 1 291.5 592A80 80 0 0 1 303.5 432z" fill="var(--red-1, #ff5252)" />
            <path d="M512 65A447 447 0 0 1 512 959L512 929A417 417 0 0 0 512 95A417 417 0 0 0 512 929L512 959A447 447 0 0 1 512 65z 
           M512 95A417 417 0 0 1 929 512A208.5 208.5 0 0 1 720.5 720.5L720.5 592A80 80 0 0 0 720.5 432A80 80 0 0 0 720.5 592L720.5 720.5A208.5 208.5 0 0 1 512 512A208.5 208.5 0 0 0 303.5 303.5A208.5 208.5 0 0 0 95 512A417 417 0 0 1 512 95z" fill="var(--red-1, #ff5252)" />
          </svg>
        
      </div>
      <div class="loading-word">Loading...</div>
    </div>
  </div>
  </div>
  <script>
    var time = null;
    var startLoading = () => {
      time = Date.now();
      document.getElementById('loader').classList.remove("loading");
    }
    var endLoading = () => {
      if (!time) {
        document.body.style.overflow = 'auto';
        document.getElementById('loader').classList.add("loading");
      } else {
        if (Date.now() - time > 500) {
          time = null;
          document.body.style.overflow = 'auto';
          document.getElementById('loader').classList.add("loading");
        } else {
          setTimeout(endLoading, 500 - (Date.now() - time));
          time = null;
        }
      }
    }
    window.addEventListener('DOMContentLoaded', endLoading);
    document.getElementById('loader').addEventListener('click', endLoading);
  </script>

<div id="copy-tooltip" style="pointer-events: none; opacity: 0; transition: all 0.2s ease; position: fixed;top: 50%;left: 50%;z-index: 999;transform: translate(-50%, -50%);color: white;background: rgba(0, 0, 0, 0.5);padding: 10px 15px;border-radius: 10px;">
</div>


    <div id="container">
      <div id="wrap">
        <div id="header-nav">
  <nav id="main-nav">
    
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon rotate">
            &#xe62b;
          </div>
          <a class="main-nav-link" href="/">Home</a>
        </span>
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon rotate">
            &#xe62b;
          </div>
          <a class="main-nav-link" href="/archives">Archives</a>
        </span>
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon rotate">
            &#xe62b;
          </div>
          <a class="main-nav-link" href="/about">About</a>
        </span>
      
    
    <a id="main-nav-toggle" class="nav-icon"></a>
  </nav>
  <nav id="sub-nav">
    
    
    
      <a id="nav-search-btn" class="nav-icon popup-trigger" title="Search"></a>
    
  </nav>
</div>
<header id="header">
  
    <picture></picture>
    <img fetchpriority="high" src="/images/posts/2025-nahamcon/nahamcon.jpg" alt="NahamCon CTF 2025">
  
  <div id="header-outer">
    <div id="header-title">
      
        
        
          <a href="/" id="logo">
            <h1 data-aos="slide-up">NahamCon CTF 2025</h1>
          </a>
        
      
      
        
        <h2 id="subtitle-wrap" data-aos="slide-down">
          
        </h2>
      
    </div>
  </div>
</header>

        <div id="content" class="sidebar-left"  >
          <aside id="sidebar">
  
  
  <div class="sidebar-wrapper wrap-sticky">
    <div class="sidebar-wrap" data-aos="fade-up">
      
        <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">Contents</h3>
  <div class="sidebar-toc-wrapper toc-div-class" >
      
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Networking"><span class="toc-number">1.</span> <span class="toc-text">Networking</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#A-Special-ID"><span class="toc-number">1.1.</span> <span class="toc-text">A Special ID</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Challenge-Description"><span class="toc-number">1.1.1.</span> <span class="toc-text">Challenge Description</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Solution"><span class="toc-number">1.1.2.</span> <span class="toc-text">Solution</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Flag"><span class="toc-number">1.1.3.</span> <span class="toc-text">Flag</span></a></li></ol></li></ol></li></ol>
      
  </div>
</div>
</div>
        <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/saturo-running-v1-6-2.gif" data-sizes="auto" alt="Harsh" class="lazyload">
  <div class="sidebar-author-name">Harsh</div>
  <div class="sidebar-description">20 | CTF Player | IN</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div>
    <div class="sidebar-state-number">9</div>
  </div>
  <div class="sidebar-state-category">
    <div>Categories</div>
    <div class="sidebar-state-number">2</div>
  </div>
  <div class="sidebar-state-tag">
    <div>Tags</div>
    <div class="sidebar-state-number">15</div>
  </div>
</div>
<div class="sidebar-social">
  
    <div class="icon-email sidebar-social-icon">
      <a href=mailto:notsoharsh13@gmail.com itemprop="url" target="_blank" aria-label="email" rel="noopener external nofollow noreferrer"></a>
    </div>
  
    <div class="icon-github sidebar-social-icon">
      <a href=https://github.com/g4rud4kun itemprop="url" target="_blank" aria-label="github" rel="noopener external nofollow noreferrer"></a>
    </div>
  
    <div class="icon-twitter sidebar-social-icon">
      <a href=https://x.com/g4rud4kun itemprop="url" target="_blank" aria-label="twitter" rel="noopener external nofollow noreferrer"></a>
    </div>
  
    <div class="icon-linkedin sidebar-social-icon">
      <a href=https://www.linkedin.com/in/harsh-gupta-b5792a280 itemprop="url" target="_blank" aria-label="linkedin" rel="noopener external nofollow noreferrer"></a>
    </div>
  
    <div class="icon-discord sidebar-social-icon">
      <a href=https://discordapp.com/users/509689286589939713 itemprop="url" target="_blank" aria-label="discord" rel="noopener external nofollow noreferrer"></a>
    </div>
  
</div>
<div class="sidebar-menu">
  
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/" aria-label="Home"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">Home</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/archives" aria-label="Archives"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">Archives</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/about" aria-label="About"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">About</div>
      </div>
    
  
</div>
</div>
      
      <!-- 
        <div class="sidebar-btn-wrapper" style="position:static">
          <div class="sidebar-toc-btn current"></div>
          <div class="sidebar-common-btn"></div>
        </div>
       -->
    </div>
  </div>

  <div class="sidebar-widget">
  
  </div>
</aside>

          <section id="main"><article id="post-NahamCon-CTF-2025" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner" data-aos="fade-up">
    <div class="article-meta">
      <div class="article-date">
  <a href="/2025/05/28/NahamCon-CTF-2025/" class="article-date-link" data-aos="zoom-in">
    <time datetime="2025-05-28T12:26:18.000Z" itemprop="datePublished">2025-05-28</time>
    <time style="display: none;" id="post-update-time">2025-06-03</time>
  </a>
</div>

      
  <div class="article-category">
    <a class="article-category-link" href="/categories/CTF-Writeups/" data-aos="zoom-in">CTF-Writeups</a>
  </div>


    </div>
    <div class="hr-line"></div>
    

    <div class="e-content article-entry" itemprop="articleBody">
      
      
        <p>I participated in NahamCon CTF 2025, organized by JohnHammond, as a member of my institute’s club, InfoSecIITR. This writeup details the challenge I solved during the competition.</p>
<h2 id="Networking"><a href="#Networking" class="headerlink" title="Networking"></a>Networking</h2><h3 id="A-Special-ID"><a href="#A-Special-ID" class="headerlink" title="A Special ID"></a>A Special ID</h3><h4 id="Challenge-Description"><a href="#Challenge-Description" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>483 points - Networking - 60 Solves - hard</p>
<p><code>Author: @Kkevsterrr</code></p>
<p>We’ve got a brand new, state of the art firewall here to protect our webserver.<br>For top of the line protection, only packets with specific IPIDs are allowed.</p>
<p>NOTE: Accessing this challenge by the link below will time out. This connection refused is intentional. The challenge is not broken, and it is your task to understand how to connect to it. Port 8080 is the only port in scope for this challenge.</p>
<p>Connect to this challenge at <code>http://137.184.230.90:8080</code></p>
<h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><p>As mentioned in the description, only packets with specific IPIDs are allowed.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">The IPID (IP Identification field) is a 16-bit field in the IPv4 header, used to uniquely identify fragments of an original IP datagram. Here&#x27;s what you need to know about its possible values in a raw packet:</span><br><span class="line"></span><br><span class="line">Possible Values for IPID</span><br><span class="line">Range: Since it&#x27;s a 16-bit field, it can hold values from:</span><br><span class="line">0 to 65535 (0x0000 to 0xFFFF)</span><br><span class="line">So any value between 0 and 65535 can legally appear as the IPID in a raw IPv4 packet.</span><br></pre></td></tr></table></figure>

<p>To exploit this, I began crafting packets using the Scapy Python library with different IPID values. Naturally, I started with 1337, a well-known number in cybersecurity culture. When I sent a SYN packet with IPID 1337, I received a SYN-ACK response with IPID 0.</p>
<p>However, when I sent an ACK packet with an IPID other than 1337, the firewall dropped it. This indicated that only packets with IPID 1337 were permitted beyond the initial handshake. So, I adjusted my approach and sent all packets with a fixed IPID of 1337.</p>
<p><strong>Initial Python Script to Send the Packets</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> scapy.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">target = <span class="string">&quot;137.184.230.90&quot;</span></span><br><span class="line">port = <span class="number">8080</span></span><br><span class="line">ipid = <span class="number">1337</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Use a fixed source port to ensure consistency</span></span><br><span class="line">src_port = <span class="number">12345</span></span><br><span class="line">seq = <span class="number">1000</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Using IPID: <span class="subst">&#123;ipid&#125;</span>, Source Port: <span class="subst">&#123;src_port&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 1: SYN</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Sending SYN...&quot;</span>)</span><br><span class="line">ip_syn = IP(dst=target, <span class="built_in">id</span>=ipid)</span><br><span class="line">syn = TCP(sport=src_port, dport=port, flags=<span class="string">&quot;S&quot;</span>, seq=seq)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Show what we&#x27;re sending</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] SYN packet details:&quot;</span>)</span><br><span class="line">(ip_syn/syn).show()</span><br><span class="line"></span><br><span class="line">synack = sr1(ip_syn/syn, timeout=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> synack:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] No response to SYN.&quot;</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Received SYN-ACK:&quot;</span>)</span><br><span class="line">synack.show()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> synack[TCP].flags != <span class="string">&#x27;SA&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] Expected SYN-ACK, got something else.&quot;</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Calculate proper sequence numbers</span></span><br><span class="line">ack_seq = seq + <span class="number">1</span></span><br><span class="line">ack_ack = synack.seq + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] ACK seq: <span class="subst">&#123;ack_seq&#125;</span>, ACK ack: <span class="subst">&#123;ack_ack&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Small delay to ensure proper timing</span></span><br><span class="line">time.sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 2: ACK</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Sending ACK...&quot;</span>)</span><br><span class="line">ip_ack = IP(dst=target, <span class="built_in">id</span>=ipid)</span><br><span class="line">ack = TCP(sport=src_port, dport=port, flags=<span class="string">&quot;A&quot;</span>, seq=ack_seq, ack=ack_ack)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Show what we&#x27;re sending</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] ACK packet details:&quot;</span>)</span><br><span class="line">(ip_ack/ack).show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Send ACK and immediately listen for response</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Sending ACK and listening for immediate response...&quot;</span>)</span><br><span class="line">response_to_ack = sr1(ip_ack/ack, timeout=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> response_to_ack:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] Response to ACK:&quot;</span>)</span><br><span class="line">    response_to_ack.show()</span><br><span class="line">    <span class="keyword">if</span> response_to_ack.haslayer(TCP) <span class="keyword">and</span> response_to_ack[TCP].flags &amp; <span class="number">0x04</span>:  <span class="comment"># RST</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] Got RST in response to ACK - connection rejected&quot;</span>)</span><br><span class="line">        exit()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] No immediate RST response to ACK - this is good!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Small delay</span></span><br><span class="line">time.sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 3: HTTP GET</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Sending HTTP GET...&quot;</span>)</span><br><span class="line">ip_http = IP(dst=target, <span class="built_in">id</span>=ipid)</span><br><span class="line">http_data = <span class="string">b&quot;GET / HTTP/1.1\r\nHost: 137.184.230.90:8080\r\nConnection: close\r\n\r\n&quot;</span></span><br><span class="line">psh = TCP(sport=src_port, dport=port, flags=<span class="string">&quot;PA&quot;</span>, seq=ack_seq, ack=ack_ack)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Show what we&#x27;re sending</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] HTTP packet details:&quot;</span>)</span><br><span class="line">(ip_http/psh).show()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[*] HTTP data: <span class="subst">&#123;http_data&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Send HTTP request</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Sending HTTP request...&quot;</span>)</span><br><span class="line">send(ip_http/psh/http_data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Now sniff for the complete HTTP response</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Sniffing for HTTP response packets...&quot;</span>)</span><br><span class="line">response_packets = sniff(<span class="built_in">filter</span>=<span class="string">f&quot;host <span class="subst">&#123;target&#125;</span>&quot;</span>, timeout=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Captured <span class="subst">&#123;<span class="built_in">len</span>(response_packets)&#125;</span> response packets:&quot;</span>)</span><br><span class="line"></span><br><span class="line">http_data_found = <span class="literal">False</span></span><br><span class="line"><span class="keyword">for</span> i, pkt <span class="keyword">in</span> <span class="built_in">enumerate</span>(response_packets):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n--- Packet <span class="subst">&#123;i+<span class="number">1</span>&#125;</span> ---&quot;</span>)</span><br><span class="line">    <span class="comment"># pkt.show()</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> pkt.haslayer(Raw):</span><br><span class="line">        raw_data = pkt[Raw].load</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] Raw data (<span class="subst">&#123;<span class="built_in">len</span>(raw_data)&#125;</span> bytes):&quot;</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            decoded = raw_data.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;replace&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(decoded)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> raw_data.lower():</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;[!] POTENTIAL FLAG FOUND!&quot;</span>)</span><br><span class="line">                http_data_found = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Binary data:&quot;</span>, raw_data[:<span class="number">100</span>])</span><br></pre></td></tr></table></figure>

<p>Output of the initial script:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">sudo</span> -E python3 ipid.py </span><br><span class="line">[+] Using IPID: 1337, Source Port: 12345</span><br><span class="line">[*] Sending SYN...</span><br><span class="line">[*] SYN packet details:</span><br><span class="line"><span class="comment">###[ IP ]###</span></span><br><span class="line">  version   = 4</span><br><span class="line">  ihl       = None</span><br><span class="line">  tos       = 0x0</span><br><span class="line">  len       = None</span><br><span class="line">  <span class="built_in">id</span>        = 1337</span><br><span class="line">  flags     = </span><br><span class="line">  frag      = 0</span><br><span class="line">  ttl       = 64</span><br><span class="line">  proto     = tcp</span><br><span class="line">  chksum    = None</span><br><span class="line">  src       = 192.168.0.100</span><br><span class="line">  dst       = 137.184.230.90</span><br><span class="line">  \options   \</span><br><span class="line"><span class="comment">###[ TCP ]###</span></span><br><span class="line">     sport     = 12345</span><br><span class="line">     dport     = http_alt</span><br><span class="line">     <span class="built_in">seq</span>       = 1000</span><br><span class="line">     ack       = 0</span><br><span class="line">     dataofs   = None</span><br><span class="line">     reserved  = 0</span><br><span class="line">     flags     = S</span><br><span class="line">     window    = 8192</span><br><span class="line">     chksum    = None</span><br><span class="line">     urgptr    = 0</span><br><span class="line">     options   = []</span><br><span class="line"></span><br><span class="line">Begin emission</span><br><span class="line">.</span><br><span class="line">Finished sending 1 packets</span><br><span class="line">*</span><br><span class="line">Received 2 packets, got 1 answers, remaining 0 packets</span><br><span class="line">[*] Received SYN-ACK:</span><br><span class="line"><span class="comment">###[ IP ]###</span></span><br><span class="line">  version   = 4</span><br><span class="line">  ihl       = 5</span><br><span class="line">  tos       = 0x34</span><br><span class="line">  len       = 44</span><br><span class="line">  <span class="built_in">id</span>        = 0</span><br><span class="line">  flags     = DF</span><br><span class="line">  frag      = 0</span><br><span class="line">  ttl       = 43</span><br><span class="line">  proto     = tcp</span><br><span class="line">  chksum    = 0x1e79</span><br><span class="line">  src       = 137.184.230.90</span><br><span class="line">  dst       = 192.168.0.100</span><br><span class="line">  \options   \</span><br><span class="line"><span class="comment">###[ TCP ]###</span></span><br><span class="line">     sport     = http_alt</span><br><span class="line">     dport     = 12345</span><br><span class="line">     <span class="built_in">seq</span>       = 1145002346</span><br><span class="line">     ack       = 1001</span><br><span class="line">     dataofs   = 6</span><br><span class="line">     reserved  = 0</span><br><span class="line">     flags     = SA</span><br><span class="line">     window    = 64240</span><br><span class="line">     chksum    = 0x7abe</span><br><span class="line">     urgptr    = 0</span><br><span class="line">     options   = [(<span class="string">&#x27;MSS&#x27;</span>, 1440)]</span><br><span class="line"></span><br><span class="line">[+] ACK <span class="built_in">seq</span>: 1001, ACK ack: 1145002347</span><br><span class="line">[*] Sending ACK...</span><br><span class="line">[*] ACK packet details:</span><br><span class="line"><span class="comment">###[ IP ]###</span></span><br><span class="line">  version   = 4</span><br><span class="line">  ihl       = None</span><br><span class="line">  tos       = 0x0</span><br><span class="line">  len       = None</span><br><span class="line">  <span class="built_in">id</span>        = 1337</span><br><span class="line">  flags     = </span><br><span class="line">  frag      = 0</span><br><span class="line">  ttl       = 64</span><br><span class="line">  proto     = tcp</span><br><span class="line">  chksum    = None</span><br><span class="line">  src       = 192.168.0.100</span><br><span class="line">  dst       = 137.184.230.90</span><br><span class="line">  \options   \</span><br><span class="line"><span class="comment">###[ TCP ]###</span></span><br><span class="line">     sport     = 12345</span><br><span class="line">     dport     = http_alt</span><br><span class="line">     <span class="built_in">seq</span>       = 1001</span><br><span class="line">     ack       = 1145002347</span><br><span class="line">     dataofs   = None</span><br><span class="line">     reserved  = 0</span><br><span class="line">     flags     = A</span><br><span class="line">     window    = 8192</span><br><span class="line">     chksum    = None</span><br><span class="line">     urgptr    = 0</span><br><span class="line">     options   = []</span><br><span class="line"></span><br><span class="line">[*] Sending ACK and listening <span class="keyword">for</span> immediate response...</span><br><span class="line">Begin emission</span><br><span class="line"></span><br><span class="line">Finished sending 1 packets</span><br><span class="line">.........</span><br><span class="line">Received 9 packets, got 0 answers, remaining 1 packets</span><br><span class="line">[+] No immediate RST response to ACK - this is good!</span><br><span class="line">[*] Sending HTTP GET...</span><br><span class="line">[*] HTTP packet details:</span><br><span class="line"><span class="comment">###[ IP ]###</span></span><br><span class="line">  version   = 4</span><br><span class="line">  ihl       = None</span><br><span class="line">  tos       = 0x0</span><br><span class="line">  len       = None</span><br><span class="line">  <span class="built_in">id</span>        = 1337</span><br><span class="line">  flags     = </span><br><span class="line">  frag      = 0</span><br><span class="line">  ttl       = 64</span><br><span class="line">  proto     = tcp</span><br><span class="line">  chksum    = None</span><br><span class="line">  src       = 192.168.0.100</span><br><span class="line">  dst       = 137.184.230.90</span><br><span class="line">  \options   \</span><br><span class="line"><span class="comment">###[ TCP ]###</span></span><br><span class="line">     sport     = 12345</span><br><span class="line">     dport     = http_alt</span><br><span class="line">     <span class="built_in">seq</span>       = 1001</span><br><span class="line">     ack       = 1145002347</span><br><span class="line">     dataofs   = None</span><br><span class="line">     reserved  = 0</span><br><span class="line">     flags     = PA</span><br><span class="line">     window    = 8192</span><br><span class="line">     chksum    = None</span><br><span class="line">     urgptr    = 0</span><br><span class="line">     options   = []</span><br><span class="line"></span><br><span class="line">[*] HTTP data: b<span class="string">&#x27;GET / HTTP/1.1\r\nHost: 137.184.230.90:8080\r\nConnection: close\r\n\r\n&#x27;</span></span><br><span class="line">[*] Sending HTTP request...</span><br><span class="line">.</span><br><span class="line">Sent 1 packets.</span><br><span class="line">[*] Sniffing <span class="keyword">for</span> HTTP response packets...</span><br><span class="line">[+] Captured 16 response packets:</span><br><span class="line"></span><br><span class="line">--- Packet 1 ---</span><br><span class="line"></span><br><span class="line">--- Packet 2 ---</span><br><span class="line">[+] Raw data (1072 bytes):</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Date: Wed, 28 May 2025 12:06:22 GMT</span><br><span class="line">Server: Apache/2.4.63 (Unix)</span><br><span class="line">Last-Modified: Fri, 23 May 2025 14:07:48 GMT</span><br><span class="line">ETag: <span class="string">&quot;7b03-635ce1f7bb500&quot;</span></span><br><span class="line">Accept-Ranges: bytes</span><br><span class="line">Content-Length: 31491</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/html</span><br><span class="line"></span><br><span class="line">Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt. Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem. Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur? Quis autem vel eum iure reprehenderit qui <span class="keyword">in</span> ea voluptate velit esse quam nihil molestiae consequatur, vel illum qui dolor</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>Despite establishing the connection, I didn’t receive the flag on the first attempt. I noticed that I was only receiving 5360 bytes, whereas the Content-Length header indicated 31491 bytes (~31.5 KB). This suggested the connection was getting terminated too early.</p>
<p>To address this, I modified the script to continuously send ACK packets to keep the TCP connection alive until the full content was received.</p>
<p>Modified Script:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> scapy.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">target = <span class="string">&quot;137.184.230.90&quot;</span></span><br><span class="line">port = <span class="number">8080</span></span><br><span class="line">ipid = <span class="number">1337</span></span><br><span class="line">src_port = <span class="number">12345</span></span><br><span class="line">seq = <span class="number">1000</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Using IPID: <span class="subst">&#123;ipid&#125;</span>, Source Port: <span class="subst">&#123;src_port&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 1: SYN</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Sending SYN...&quot;</span>)</span><br><span class="line">ip_syn = IP(dst=target, <span class="built_in">id</span>=ipid)</span><br><span class="line">syn = TCP(sport=src_port, dport=port, flags=<span class="string">&quot;S&quot;</span>, seq=seq)</span><br><span class="line"></span><br><span class="line">synack = sr1(ip_syn/syn, timeout=<span class="number">5</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> synack:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] No response to SYN.&quot;</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Received SYN-ACK&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> synack[TCP].flags != <span class="string">&#x27;SA&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] Expected SYN-ACK, got something else.&quot;</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Calculate proper sequence numbers</span></span><br><span class="line">ack_seq = seq + <span class="number">1</span></span><br><span class="line">ack_ack = synack.seq + <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] ACK seq: <span class="subst">&#123;ack_seq&#125;</span>, ACK ack: <span class="subst">&#123;ack_ack&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 2: ACK</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Sending ACK...&quot;</span>)</span><br><span class="line">ip_ack = IP(dst=target, <span class="built_in">id</span>=ipid)</span><br><span class="line">ack = TCP(sport=src_port, dport=port, flags=<span class="string">&quot;A&quot;</span>, seq=ack_seq, ack=ack_ack)</span><br><span class="line"></span><br><span class="line">response_to_ack = sr1(ip_ack/ack, timeout=<span class="number">2</span>)</span><br><span class="line"><span class="keyword">if</span> response_to_ack:</span><br><span class="line">    <span class="keyword">if</span> response_to_ack.haslayer(TCP) <span class="keyword">and</span> response_to_ack[TCP].flags &amp; <span class="number">0x04</span>:  <span class="comment"># RST</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] Got RST in response to ACK - connection rejected&quot;</span>)</span><br><span class="line">        exit()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] No immediate response to ACK - this is good!&quot;</span>)</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 3: HTTP GET</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Sending HTTP GET...&quot;</span>)</span><br><span class="line">ip_http = IP(dst=target, <span class="built_in">id</span>=ipid)</span><br><span class="line">http_data = <span class="string">b&quot;GET / HTTP/1.1\r\nHost: 137.184.230.90:8080\r\nConnection: close\r\n\r\n&quot;</span></span><br><span class="line">psh = TCP(sport=src_port, dport=port, flags=<span class="string">&quot;PA&quot;</span>, seq=ack_seq, ack=ack_ack)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Sending HTTP request...&quot;</span>)</span><br><span class="line">send(ip_http/psh/http_data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Global variables for TCP state management</span></span><br><span class="line">current_ack = ack_ack</span><br><span class="line">my_seq = ack_seq + <span class="built_in">len</span>(http_data)</span><br><span class="line">received_data = <span class="string">b&quot;&quot;</span></span><br><span class="line">content_length = <span class="literal">None</span></span><br><span class="line">headers_complete = <span class="literal">False</span></span><br><span class="line">capture_active = <span class="literal">True</span></span><br><span class="line">packets_received = <span class="number">0</span></span><br><span class="line">tcp_segments = &#123;&#125;  <span class="comment"># Store out-of-order segments</span></span><br><span class="line">expected_seq = ack_ack</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_ack</span>(<span class="params">ack_num</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Send an ACK packet to acknowledge received data&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">global</span> my_seq</span><br><span class="line">    ack_pkt = IP(dst=target, <span class="built_in">id</span>=ipid) / TCP(</span><br><span class="line">        sport=src_port, </span><br><span class="line">        dport=port, </span><br><span class="line">        flags=<span class="string">&quot;A&quot;</span>, </span><br><span class="line">        seq=my_seq, </span><br><span class="line">        ack=ack_num,</span><br><span class="line">        window=<span class="number">65535</span>  <span class="comment"># Large window size</span></span><br><span class="line">    )</span><br><span class="line">    send(ack_pkt, verbose=<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] Sent ACK: seq=<span class="subst">&#123;my_seq&#125;</span>, ack=<span class="subst">&#123;ack_num&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_response_packet</span>(<span class="params">pkt</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Process incoming TCP packets and send ACKs&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">global</span> current_ack, received_data, content_length, headers_complete, capture_active, packets_received, tcp_segments, expected_seq</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (pkt.haslayer(IP) <span class="keyword">and</span> pkt.haslayer(TCP) <span class="keyword">and</span> </span><br><span class="line">        pkt[IP].src == target <span class="keyword">and</span> pkt[TCP].sport == port <span class="keyword">and</span> </span><br><span class="line">        pkt[TCP].dport == src_port):</span><br><span class="line">        </span><br><span class="line">        packets_received += <span class="number">1</span></span><br><span class="line">        tcp_layer = pkt[TCP]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Check for data</span></span><br><span class="line">        <span class="keyword">if</span> pkt.haslayer(Raw):</span><br><span class="line">            data = pkt[Raw].load</span><br><span class="line">            tcp_seq = tcp_layer.seq</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[*] Packet <span class="subst">&#123;packets_received&#125;</span>: seq=<span class="subst">&#123;tcp_seq&#125;</span>, len=<span class="subst">&#123;<span class="built_in">len</span>(data)&#125;</span>, expected_seq=<span class="subst">&#123;expected_seq&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Store the segment regardless of order</span></span><br><span class="line">            tcp_segments[tcp_seq] = data</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Always send ACK for received data to keep connection alive</span></span><br><span class="line">            ack_for_this_packet = tcp_seq + <span class="built_in">len</span>(data)</span><br><span class="line">            send_ack(ack_for_this_packet)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Try to reassemble consecutive data</span></span><br><span class="line">            reassemble_data()</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Check if we have all data</span></span><br><span class="line">            <span class="keyword">if</span> headers_complete <span class="keyword">and</span> content_length:</span><br><span class="line">                headers_end = received_data.find(<span class="string">b&#x27;\r\n\r\n&#x27;</span>) + <span class="number">4</span></span><br><span class="line">                body_length = <span class="built_in">len</span>(received_data) - headers_end</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;[*] Body progress: <span class="subst">&#123;body_length&#125;</span>/<span class="subst">&#123;content_length&#125;</span> bytes (<span class="subst">&#123;body_length/content_length*<span class="number">100</span>:<span class="number">.1</span>f&#125;</span>%)&quot;</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> body_length &gt;= content_length:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;[+] All data received!&quot;</span>)</span><br><span class="line">                    capture_active = <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Handle connection close - but don&#x27;t stop immediately, try to get more data</span></span><br><span class="line">        <span class="keyword">if</span> tcp_layer.flags &amp; <span class="number">0x01</span>:  <span class="comment"># FIN</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[*] FIN received - server wants to close connection&quot;</span>)</span><br><span class="line">            <span class="comment"># Send ACK for FIN but don&#x27;t close immediately</span></span><br><span class="line">            send_ack(tcp_layer.seq + <span class="number">1</span>)</span><br><span class="line">            <span class="comment"># Don&#x27;t send our own FIN yet, try to get more data</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[*] Continuing to wait for more data...&quot;</span>)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">if</span> tcp_layer.flags &amp; <span class="number">0x04</span>:  <span class="comment"># RST</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[*] RST received - connection reset&quot;</span>)</span><br><span class="line">            capture_active = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reassemble_data</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Reassemble TCP segments in order&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">global</span> received_data, expected_seq, headers_complete, content_length</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Try to find consecutive segments starting from expected_seq</span></span><br><span class="line">    temp_data = received_data</span><br><span class="line">    current_expected = expected_seq</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> current_expected <span class="keyword">in</span> tcp_segments:</span><br><span class="line">        segment_data = tcp_segments[current_expected]</span><br><span class="line">        temp_data += segment_data</span><br><span class="line">        current_expected += <span class="built_in">len</span>(segment_data)</span><br><span class="line">        <span class="comment"># Remove processed segment</span></span><br><span class="line">        <span class="keyword">del</span> tcp_segments[current_expected - <span class="built_in">len</span>(segment_data)]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Update global state</span></span><br><span class="line">    received_data = temp_data</span><br><span class="line">    expected_seq = current_expected</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Parse headers if not done yet</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> headers_complete <span class="keyword">and</span> <span class="string">b&#x27;\r\n\r\n&#x27;</span> <span class="keyword">in</span> received_data:</span><br><span class="line">        headers_end = received_data.find(<span class="string">b&#x27;\r\n\r\n&#x27;</span>) + <span class="number">4</span></span><br><span class="line">        headers = received_data[:headers_end]</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] Headers parsed!&quot;</span>)</span><br><span class="line">        headers_str = headers.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;replace&#x27;</span>)</span><br><span class="line">        content_match = re.search(<span class="string">r&#x27;Content-Length:\s*(\d+)&#x27;</span>, headers_str, re.IGNORECASE)</span><br><span class="line">        <span class="keyword">if</span> content_match:</span><br><span class="line">            content_length = <span class="built_in">int</span>(content_match.group(<span class="number">1</span>))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[+] Content-Length: <span class="subst">&#123;content_length&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        headers_complete = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Start active packet capture with response processing</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Starting active TCP capture...&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Will send ACKs for received data to keep connection alive&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use a custom sniffing approach with timeout and active ACK sending</span></span><br><span class="line">start_time = time.time()</span><br><span class="line">timeout_duration = <span class="number">180</span>  <span class="comment"># 3 minutes timeout</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Sniff packets and process them</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    packets = sniff(</span><br><span class="line">        <span class="built_in">filter</span>=<span class="string">f&quot;host <span class="subst">&#123;target&#125;</span> and port <span class="subst">&#123;port&#125;</span>&quot;</span>,</span><br><span class="line">        stop_filter=process_response_packet,</span><br><span class="line">        timeout=timeout_duration</span><br><span class="line">    )</span><br><span class="line"><span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n[*] Interrupted by user&quot;</span>)</span><br><span class="line">    capture_active = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Try to get any remaining out-of-order packets</span></span><br><span class="line"><span class="keyword">if</span> tcp_segments:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] Processing <span class="subst">&#123;<span class="built_in">len</span>(tcp_segments)&#125;</span> out-of-order segments...&quot;</span>)</span><br><span class="line">    reassemble_data()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;\n[+] Capture completed!&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Total packets received: <span class="subst">&#123;packets_received&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Total data received: <span class="subst">&#123;<span class="built_in">len</span>(received_data)&#125;</span> bytes&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> content_length:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] Expected: <span class="subst">&#123;content_length&#125;</span> bytes&quot;</span>)</span><br><span class="line">    headers_end = received_data.find(<span class="string">b&#x27;\r\n\r\n&#x27;</span>) + <span class="number">4</span></span><br><span class="line">    body_length = <span class="built_in">len</span>(received_data) - headers_end</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] Body received: <span class="subst">&#123;body_length&#125;</span> bytes (<span class="subst">&#123;body_length/content_length*<span class="number">100</span>:<span class="number">.1</span>f&#125;</span>%)&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Save all received data to file</span></span><br><span class="line">timestamp = <span class="built_in">int</span>(time.time())</span><br><span class="line">filename = <span class="string">f&quot;http_response_<span class="subst">&#123;timestamp&#125;</span>.txt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;\n[*] Saving complete response to <span class="subst">&#123;filename&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;replace&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        full_text = received_data.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;replace&#x27;</span>)</span><br><span class="line">        f.write(full_text)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] Saved <span class="subst">&#123;<span class="built_in">len</span>(full_text)&#125;</span> characters to <span class="subst">&#123;filename&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[!] Error saving as text: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># If we didn&#x27;t get all data, try one more aggressive capture</span></span><br><span class="line"><span class="keyword">if</span> content_length <span class="keyword">and</span> <span class="built_in">len</span>(received_data) - received_data.find(<span class="string">b&#x27;\r\n\r\n&#x27;</span>) - <span class="number">4</span> &lt; content_length:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n[*] Missing data detected. Trying additional capture...&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] Making another request to get remaining data...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Make another request (servers sometimes have issues with single requests)</span></span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    send(ip_http/psh/http_data)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Capture for a shorter time</span></span><br><span class="line">    additional_packets = sniff(</span><br><span class="line">        <span class="built_in">filter</span>=<span class="string">f&quot;src host <span class="subst">&#123;target&#125;</span> and src port <span class="subst">&#123;port&#125;</span>&quot;</span>,</span><br><span class="line">        timeout=<span class="number">30</span>,</span><br><span class="line">        count=<span class="number">50</span></span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] Captured <span class="subst">&#123;<span class="built_in">len</span>(additional_packets)&#125;</span> additional packets&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Process additional packets</span></span><br><span class="line">    <span class="keyword">for</span> pkt <span class="keyword">in</span> additional_packets:</span><br><span class="line">        <span class="keyword">if</span> pkt.haslayer(Raw):</span><br><span class="line">            <span class="comment"># This is a simple append - in production you&#x27;d want proper TCP reassembly</span></span><br><span class="line">            additional_data = pkt[Raw].load</span><br><span class="line">            <span class="comment"># Only add if it looks like new data</span></span><br><span class="line">            <span class="keyword">if</span> additional_data <span class="keyword">not</span> <span class="keyword">in</span> received_data:</span><br><span class="line">                received_data += additional_data</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;[*] Added <span class="subst">&#123;<span class="built_in">len</span>(additional_data)&#125;</span> bytes of additional data&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Save updated data</span></span><br><span class="line">    updated_filename = <span class="string">f&quot;http_response_updated_<span class="subst">&#123;timestamp&#125;</span>.txt&quot;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(updated_filename, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;replace&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            full_text = received_data.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;replace&#x27;</span>)</span><br><span class="line">            f.write(full_text)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[+] Saved updated response (<span class="subst">&#123;<span class="built_in">len</span>(full_text)&#125;</span> chars) to <span class="subst">&#123;updated_filename&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[!] Error saving updated text: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Process the complete response</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">b&#x27;\r\n\r\n&#x27;</span> <span class="keyword">in</span> received_data:</span><br><span class="line">    headers_end = received_data.find(<span class="string">b&#x27;\r\n\r\n&#x27;</span>) + <span class="number">4</span></span><br><span class="line">    headers = received_data[:headers_end]</span><br><span class="line">    body = received_data[headers_end:]</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n[+] HTTP Headers:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(headers.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;replace&#x27;</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n[+] HTTP Response Body (<span class="subst">&#123;<span class="built_in">len</span>(body)&#125;</span> bytes):&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        body_text = body.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;replace&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Enhanced flag detection</span></span><br><span class="line">        flag_patterns = [</span><br><span class="line">            <span class="string">r&#x27;flag\&#123;[^&#125;]+\&#125;&#x27;</span>,</span><br><span class="line">            <span class="string">r&#x27;FLAG\&#123;[^&#125;]+\&#125;&#x27;</span></span><br><span class="line">        ]</span><br><span class="line">        </span><br><span class="line">        flags_found = []</span><br><span class="line">        <span class="keyword">for</span> pattern <span class="keyword">in</span> flag_patterns:</span><br><span class="line">            matches = re.findall(pattern, body_text, re.IGNORECASE)</span><br><span class="line">            flags_found.extend(matches)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> flags_found:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[!] POTENTIAL FLAGS FOUND:&quot;</span>)</span><br><span class="line">            <span class="keyword">for</span> flag <span class="keyword">in</span> <span class="built_in">sorted</span>(<span class="built_in">set</span>(flags_found)):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;    <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="comment"># Display sample of content</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n[*] First 1000 characters:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(body_text[:<span class="number">1000</span>])</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(body_text) &gt; <span class="number">2000</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\n[*] Last 1000 characters:&quot;</span>)  </span><br><span class="line">            <span class="built_in">print</span>(body_text[-<span class="number">1000</span>:])</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[*] Could not decode body as text: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[*] Raw body (first 500 bytes): <span class="subst">&#123;body[:<span class="number">500</span>]&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n[*] Script executed&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>Output of the modified script:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">sudo</span> -E python3 ipid.py </span><br><span class="line">[+] Using IPID: 1337, Source Port: 12345</span><br><span class="line">[*] Sending SYN...</span><br><span class="line">Begin emission</span><br><span class="line">.</span><br><span class="line">Finished sending 1 packets</span><br><span class="line">*</span><br><span class="line">Received 2 packets, got 1 answers, remaining 0 packets</span><br><span class="line">[*] Received SYN-ACK</span><br><span class="line">[+] ACK <span class="built_in">seq</span>: 1001, ACK ack: 1710788324</span><br><span class="line">[*] Sending ACK...</span><br><span class="line">Begin emission</span><br><span class="line"></span><br><span class="line">Finished sending 1 packets</span><br><span class="line">.</span><br><span class="line">Received 1 packets, got 0 answers, remaining 1 packets</span><br><span class="line">[+] No immediate response to ACK - this is good!</span><br><span class="line">[*] Sending HTTP GET...</span><br><span class="line">[*] Sending HTTP request...</span><br><span class="line">.</span><br><span class="line">Sent 1 packets.</span><br><span class="line">[*] Starting active TCP capture...</span><br><span class="line">[*] Will send ACKs <span class="keyword">for</span> received data to keep connection alive</span><br><span class="line">[*] Packet 2: <span class="built_in">seq</span>=1710788324, len=1072, expected_seq=1710788324</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710789396</span><br><span class="line">[+] Headers parsed!</span><br><span class="line">[+] Content-Length: 31491</span><br><span class="line">[*] Body progress: 823/31491 bytes (2.6%)</span><br><span class="line">[*] Packet 3: <span class="built_in">seq</span>=1710789396, len=1072, expected_seq=1710789396</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710790468</span><br><span class="line">[*] Body progress: 1895/31491 bytes (6.0%)</span><br><span class="line">[*] Packet 4: <span class="built_in">seq</span>=1710790468, len=1072, expected_seq=1710790468</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710791540</span><br><span class="line">[*] Body progress: 2967/31491 bytes (9.4%)</span><br><span class="line">[*] Packet 5: <span class="built_in">seq</span>=1710791540, len=1072, expected_seq=1710791540</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710792612</span><br><span class="line">[*] Body progress: 4039/31491 bytes (12.8%)</span><br><span class="line">[*] Packet 6: <span class="built_in">seq</span>=1710792612, len=536, expected_seq=1710792612</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710793148</span><br><span class="line">[*] Body progress: 4575/31491 bytes (14.5%)</span><br><span class="line">[*] Packet 7: <span class="built_in">seq</span>=1710793148, len=536, expected_seq=1710793148</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710793684</span><br><span class="line">[*] Body progress: 5111/31491 bytes (16.2%)</span><br><span class="line">[*] Packet 8: <span class="built_in">seq</span>=1710793684, len=536, expected_seq=1710793684</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710794220</span><br><span class="line">[*] Body progress: 5647/31491 bytes (17.9%)</span><br><span class="line">[*] Packet 9: <span class="built_in">seq</span>=1710794220, len=536, expected_seq=1710794220</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710794756</span><br><span class="line">[*] Body progress: 6183/31491 bytes (19.6%)</span><br><span class="line">[*] Packet 10: <span class="built_in">seq</span>=1710794756, len=1072, expected_seq=1710794756</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710795828</span><br><span class="line">[*] Body progress: 7255/31491 bytes (23.0%)</span><br><span class="line">[*] Packet 11: <span class="built_in">seq</span>=1710795828, len=1072, expected_seq=1710795828</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710796900</span><br><span class="line">[*] Body progress: 8327/31491 bytes (26.4%)</span><br><span class="line">[*] Packet 12: <span class="built_in">seq</span>=1710796900, len=1072, expected_seq=1710796900</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710797972</span><br><span class="line">[*] Body progress: 9399/31491 bytes (29.8%)</span><br><span class="line">[*] Packet 13: <span class="built_in">seq</span>=1710797972, len=1072, expected_seq=1710797972</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710799044</span><br><span class="line">[*] Body progress: 10471/31491 bytes (33.3%)</span><br><span class="line">[*] Packet 14: <span class="built_in">seq</span>=1710799044, len=1072, expected_seq=1710799044</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710800116</span><br><span class="line">[*] Body progress: 11543/31491 bytes (36.7%)</span><br><span class="line">[*] Packet 15: <span class="built_in">seq</span>=1710800116, len=536, expected_seq=1710800116</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710800652</span><br><span class="line">[*] Body progress: 12079/31491 bytes (38.4%)</span><br><span class="line">[*] Packet 16: <span class="built_in">seq</span>=1710800652, len=536, expected_seq=1710800652</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710801188</span><br><span class="line">[*] Body progress: 12615/31491 bytes (40.1%)</span><br><span class="line">[*] Packet 17: <span class="built_in">seq</span>=1710801188, len=536, expected_seq=1710801188</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710801724</span><br><span class="line">[*] Body progress: 13151/31491 bytes (41.8%)</span><br><span class="line">[*] Packet 18: <span class="built_in">seq</span>=1710801724, len=536, expected_seq=1710801724</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710802260</span><br><span class="line">[*] Body progress: 13687/31491 bytes (43.5%)</span><br><span class="line">[*] Packet 19: <span class="built_in">seq</span>=1710802260, len=1072, expected_seq=1710802260</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710803332</span><br><span class="line">[*] Body progress: 14759/31491 bytes (46.9%)</span><br><span class="line">[*] Packet 20: <span class="built_in">seq</span>=1710803332, len=1072, expected_seq=1710803332</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710804404</span><br><span class="line">[*] Body progress: 15831/31491 bytes (50.3%)</span><br><span class="line">[*] Packet 21: <span class="built_in">seq</span>=1710804404, len=1072, expected_seq=1710804404</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710805476</span><br><span class="line">[*] Body progress: 16903/31491 bytes (53.7%)</span><br><span class="line">[*] Packet 22: <span class="built_in">seq</span>=1710805476, len=1072, expected_seq=1710805476</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710806548</span><br><span class="line">[*] Body progress: 17975/31491 bytes (57.1%)</span><br><span class="line">[*] Packet 23: <span class="built_in">seq</span>=1710806548, len=536, expected_seq=1710806548</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710807084</span><br><span class="line">[*] Body progress: 18511/31491 bytes (58.8%)</span><br><span class="line">[*] Packet 24: <span class="built_in">seq</span>=1710807084, len=536, expected_seq=1710807084</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710807620</span><br><span class="line">[*] Body progress: 19047/31491 bytes (60.5%)</span><br><span class="line">[*] Packet 25: <span class="built_in">seq</span>=1710807620, len=1072, expected_seq=1710807620</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710808692</span><br><span class="line">[*] Body progress: 20119/31491 bytes (63.9%)</span><br><span class="line">[*] Packet 26: <span class="built_in">seq</span>=1710808692, len=1072, expected_seq=1710808692</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710809764</span><br><span class="line">[*] Body progress: 21191/31491 bytes (67.3%)</span><br><span class="line">[*] Packet 27: <span class="built_in">seq</span>=1710809764, len=1072, expected_seq=1710809764</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710810836</span><br><span class="line">[*] Body progress: 22263/31491 bytes (70.7%)</span><br><span class="line">[*] Packet 28: <span class="built_in">seq</span>=1710810836, len=1072, expected_seq=1710810836</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710811908</span><br><span class="line">[*] Body progress: 23335/31491 bytes (74.1%)</span><br><span class="line">[*] Packet 29: <span class="built_in">seq</span>=1710811908, len=536, expected_seq=1710811908</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710812444</span><br><span class="line">[*] Body progress: 23871/31491 bytes (75.8%)</span><br><span class="line">[*] Packet 30: <span class="built_in">seq</span>=1710812444, len=536, expected_seq=1710812444</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710812980</span><br><span class="line">[*] Body progress: 24407/31491 bytes (77.5%)</span><br><span class="line">[*] Packet 31: <span class="built_in">seq</span>=1710812980, len=1072, expected_seq=1710812980</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710814052</span><br><span class="line">[*] Body progress: 25479/31491 bytes (80.9%)</span><br><span class="line">[*] Packet 32: <span class="built_in">seq</span>=1710814052, len=1072, expected_seq=1710814052</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710815124</span><br><span class="line">[*] Body progress: 26551/31491 bytes (84.3%)</span><br><span class="line">[*] Packet 33: <span class="built_in">seq</span>=1710815124, len=1072, expected_seq=1710815124</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710816196</span><br><span class="line">[*] Body progress: 27623/31491 bytes (87.7%)</span><br><span class="line">[*] Packet 34: <span class="built_in">seq</span>=1710816196, len=1072, expected_seq=1710816196</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710817268</span><br><span class="line">[*] Body progress: 28695/31491 bytes (91.1%)</span><br><span class="line">[*] Packet 35: <span class="built_in">seq</span>=1710817268, len=1072, expected_seq=1710817268</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710818340</span><br><span class="line">[*] Body progress: 29767/31491 bytes (94.5%)</span><br><span class="line">[*] Packet 36: <span class="built_in">seq</span>=1710818340, len=1072, expected_seq=1710818340</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710819412</span><br><span class="line">[*] Body progress: 30839/31491 bytes (97.9%)</span><br><span class="line">[*] Packet 37: <span class="built_in">seq</span>=1710819412, len=652, expected_seq=1710819412</span><br><span class="line">[*] Sent ACK: <span class="built_in">seq</span>=1065, ack=1710820064</span><br><span class="line">[*] Body progress: 31491/31491 bytes (100.0%)</span><br><span class="line">[+] All data received!</span><br><span class="line"></span><br><span class="line">[+] Capture completed!</span><br><span class="line">[+] Total packets received: 37</span><br><span class="line">[+] Total data received: 31740 bytes</span><br><span class="line">[+] Expected: 31491 bytes</span><br><span class="line">[+] Body received: 31491 bytes (100.0%)</span><br><span class="line"></span><br><span class="line">[*] Saving complete response to http_response_1748338637.txt</span><br><span class="line">[+] Saved 31740 characters to http_response_1748338637.txt</span><br><span class="line"></span><br><span class="line">[+] HTTP Headers:</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Date: Tue, 27 May 2025 09:37:16 GMT</span><br><span class="line">Server: Apache/2.4.63 (Unix)</span><br><span class="line">Last-Modified: Fri, 23 May 2025 14:07:48 GMT</span><br><span class="line">ETag: <span class="string">&quot;7b03-635ce1f7bb500&quot;</span></span><br><span class="line">Accept-Ranges: bytes</span><br><span class="line">Content-Length: 31491</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/html</span><br><span class="line"></span><br><span class="line">[+] HTTP Response Body (31491 bytes):</span><br><span class="line">[!] POTENTIAL FLAGS FOUND:</span><br><span class="line">    flag&#123;4e3dd38dcd14821aa327e2c96af2799d&#125;</span><br><span class="line"></span><br><span class="line">[*] First 1000 characters:</span><br><span class="line">Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt. Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem. Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur? Quis autem vel eum iure reprehenderit qui <span class="keyword">in</span> ea voluptate velit esse quam nihil molestiae consequatur, vel illum qui dolorem eum fugiat quo voluptas nulla pariatur?</span><br><span class="line">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed <span class="keyword">do</span> eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad</span><br><span class="line"></span><br><span class="line">[*] Last 1000 characters:</span><br><span class="line">itur porta porta nulla, sit amet suscipit nisi ornare <span class="keyword">in</span>. Etiam pharetra vitae lacus <span class="keyword">in</span> mollis. Suspendisse gravida erat lectus, non suscipit lacus vulputate vel. Proin ut nibh feugiat, mollis nunc <span class="built_in">id</span>, semper sapien. Ut cursus orci purus, quis viverra nisi dapibus quis. Curabitur faucibus porttitor ex at pulvinar. Ut facilisis purus eget enim blandit bibendum. Vivamus vehicula non ligula vitae eleifend.</span><br><span class="line"></span><br><span class="line">Phasellus ac libero turpis. Nunc dictum magna vehicula, vestibulum mauris eu, congue ex. Integer leo sem, mattis non neque a, semper rutrum nisi. Proin lobortis leo venenatis ornare imperdiet. Donec ut cursus eros. Maecenas quis malesuada odio. Etiam quis commodo ante. Suspendisse varius dui ac lacus maximus, <span class="keyword">in</span> pharetra dolor laoreet. Praesent est urna, pretium non fringilla pretium, finibus vel magna. Integer ultrices sit amet sapien cursus pretium. Etiam suscipit ipsum <span class="keyword">in</span> facilisis suscipit. Cras interdum urna sed nisl suscipit interdum.</span><br><span class="line"></span><br><span class="line">fin: flag&#123;4e3dd38dcd14821aa327e2c96af2799d&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[*] Script executed</span><br></pre></td></tr></table></figure>

<h4 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">flag&#123;4e3dd38dcd14821aa327e2c96af2799d&#125;</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      
      
      
      
      
      
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item" data-aos="zoom-in"><a class="article-tag-list-link" href="/tags/forensics/" rel="tag">forensics</a></li><li class="article-tag-list-item" data-aos="zoom-in"><a class="article-tag-list-link" href="/tags/networking/" rel="tag">networking</a></li><li class="article-tag-list-item" data-aos="zoom-in"><a class="article-tag-list-link" href="/tags/scapy/" rel="tag">scapy</a></li></ul>


    </footer>
  </div>
  
  <nav id="article-nav" data-aos="fade-up">
    
      <div class="article-nav-link-wrap article-nav-link-left">
        
          <img data-src="/images/posts/2025-voip/voip.png" data-sizes="auto" alt="VoIP Setup for Beginners: Daily Use, CTF Challenges, and Wireshark Deep Dive" class="lazyload">
        
        <a href="/2025/05/28/VoIP-Setup-for-Beginners-Daily-Use-CTF-Challenges-and-Wireshark-Deep-Dive/"></a>
        <div class="article-nav-caption">Newer</div>
        <h3 class="article-nav-title">
          
            VoIP Setup for Beginners: Daily Use, CTF Challenges, and Wireshark Deep Dive
          
        </h3>
      </div>
    
    
    <div class="article-nav-link-wrap article-nav-link-right">
      
        <img data-src="/images/posts/2025-byuctf/byuctf2025.png" data-sizes="auto" alt="BYUCTF 2025" class="lazyload">
      
      <a href="/2025/05/18/BYUCTF-2025/"></a>
      <div class="article-nav-caption">Older</div>
      <h3 class="article-nav-title">
        
          BYUCTF 2025
        
      </h3>
    </div>
    
  </nav>


</article>






</section>
        </div>
        
        
        <footer id="footer">
  <div style="width: 100%; overflow: hidden">
    <div class="footer-line"></div>
  </div>
  <div id="footer-info">
    
    <div>
      <span class="icon-copyright"></span>
      2024-2025
      <span class="footer-info-sep rotate"></span>
      Harsh
    </div>
    
    
      <div>
        <span class="icon-brush"></span>
        27.7k
        &nbsp;|&nbsp;
        <span class="icon-coffee"></span>
        02:50
      </div>
    
    
    
    
  </div>
</footer>

        
          <div class="sidebar-top">
            <div class="sidebar-top-taichi rotate"></div>
            <div class="arrow-up"></div>
          </div>
        
        <div id="mask" class="hide"></div>
      </div>
      <nav id="mobile-nav">
  <div class="sidebar-wrap">
    
      <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">Contents</h3>
  <div class="sidebar-toc-wrapper toc-div-class" >
      
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Networking"><span class="toc-number">1.</span> <span class="toc-text">Networking</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#A-Special-ID"><span class="toc-number">1.1.</span> <span class="toc-text">A Special ID</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Challenge-Description"><span class="toc-number">1.1.1.</span> <span class="toc-text">Challenge Description</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Solution"><span class="toc-number">1.1.2.</span> <span class="toc-text">Solution</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Flag"><span class="toc-number">1.1.3.</span> <span class="toc-text">Flag</span></a></li></ol></li></ol></li></ol>
      
  </div>
</div>
</div>
      <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/saturo-running-v1-6-2.gif" data-sizes="auto" alt="Harsh" class="lazyload">
  <div class="sidebar-author-name">Harsh</div>
  <div class="sidebar-description">20 | CTF Player | IN</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div>
    <div class="sidebar-state-number">9</div>
  </div>
  <div class="sidebar-state-category">
    <div>Categories</div>
    <div class="sidebar-state-number">2</div>
  </div>
  <div class="sidebar-state-tag">
    <div>Tags</div>
    <div class="sidebar-state-number">15</div>
  </div>
</div>
<div class="sidebar-social">
  
    <div class="icon-email sidebar-social-icon">
      <a href=mailto:notsoharsh13@gmail.com itemprop="url" target="_blank" aria-label="email" rel="noopener external nofollow noreferrer"></a>
    </div>
  
    <div class="icon-github sidebar-social-icon">
      <a href=https://github.com/g4rud4kun itemprop="url" target="_blank" aria-label="github" rel="noopener external nofollow noreferrer"></a>
    </div>
  
    <div class="icon-twitter sidebar-social-icon">
      <a href=https://x.com/g4rud4kun itemprop="url" target="_blank" aria-label="twitter" rel="noopener external nofollow noreferrer"></a>
    </div>
  
    <div class="icon-linkedin sidebar-social-icon">
      <a href=https://www.linkedin.com/in/harsh-gupta-b5792a280 itemprop="url" target="_blank" aria-label="linkedin" rel="noopener external nofollow noreferrer"></a>
    </div>
  
    <div class="icon-discord sidebar-social-icon">
      <a href=https://discordapp.com/users/509689286589939713 itemprop="url" target="_blank" aria-label="discord" rel="noopener external nofollow noreferrer"></a>
    </div>
  
</div>
<div class="sidebar-menu">
  
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/" aria-label="Home"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">Home</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/archives" aria-label="Archives"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">Archives</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/about" aria-label="About"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">About</div>
      </div>
    
  
</div>
</div>
    
  </div>
  
    <div class="sidebar-btn-wrapper">
      <div class="sidebar-toc-btn current"></div>
      <div class="sidebar-common-btn"></div>
    </div>
  
</nav>

    </div>
    
      <div class="site-search">
        <div class="reimu-popup popup">
          <div class="reimu-search">
            <div class="reimu-search-input-icon"></div>
            <div class="reimu-search-input" id="reimu-search-input"></div>
            <div class="popup-btn-close"></div>
          </div>
          <div class="reimu-results">
            <div id="reimu-stats"></div>
            <div id="reimu-hits"></div>
            <div id="reimu-pagination" class="reimu-pagination"></div>
          </div>
          <img class="reimu-bg" src="/images/Satoru-Gojo-White-Hair-BlindfoldSatoru-Gojo.png"/>
        </div>
      </div>
    
    
<script src="https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js" integrity="sha384-3gT&#x2F;vsepWkfz&#x2F;ff7PpWNUeMzeWoH3cDhm&#x2F;A8jM7ouoAK0&#x2F;fP&#x2F;9bcHHR5kHq2nf+e" crossorigin="anonymous"></script>


<script src="https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js" integrity="sha384-J08i8An&#x2F;QeARD9ExYpvphB8BsyOj3Gh2TSh1aLINKO3L0cMSH2dN3E22zFoXEi0Q" crossorigin="anonymous"></script>



<script src="/js/script.js"></script>



  
<script src="/js/aos.js"></script>

  <script>
    var aosInit = () => {
      AOS.init({
        duration: 1000,
        easing: "ease",
        once: true,
        offset: 50,
      });
    };
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', aosInit);
    } else {
      aosInit();
    }
  </script>



<script src="/js/pjax_script.js" data-pjax></script>



  
<script src="/js/generator_search.js" defer></script>















<div id="lazy-script">
  <div>
    
      
      
      <script data-pjax>
        window.REIMU_POST = {
          author: "Harsh",
          title: "NahamCon CTF 2025",
          url: "https://g4rud4kun.github.io/2025/05/28/NahamCon-CTF-2025/",
          excerpt: "",
          description: "",
          stripContent: "I participated in NahamCon CTF 2025, organized by JohnHammond, as a member of my institute’s club, InfoSecIITR. This writeup details the challenge I solved during the competition. NetworkingA Special IDChallenge Description483 points - Networking - 6",
          date: "Wed May 28 2025 17:56:18 GMT+0530",
          updated: "Tue Jun 03 2025 18:56:00 GMT+0530",
          cover: "/images/posts/2025-nahamcon/nahamcon.jpg",
        };
      </script>
       
    
    
      
        
<script src="/js/insert_highlight.js" data-pjax></script>

        
      
    
    
      <script type="module" data-pjax>
        const PhotoSwipeLightbox = (await safeImport("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe-lightbox.esm.min.js", "sha384-DiL6M/gG+wmTxmCRZyD1zee6lIhawn5TGvED0FOh7fXcN9B0aZ9dexSF/N6lrZi/")).default;
        
        const pswp = () => {
          if (_$$('.article-entry a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-entry',
              children: 'a.article-gallery-item',
              pswpModule: () => safeImport("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8+oTJ7m3DfYEWX1fu1scuS4+s")
            }).init();
          }
          if(_$$('.article-gallery a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-gallery',
              children: 'a.article-gallery-item',
              pswpModule: () => safeImport("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8+oTJ7m3DfYEWX1fu1scuS4+s")
            }).init();
          }
          window.lightboxStatus = 'done';
          window.removeEventListener('lightbox:ready', pswp);
        }
        if(window.lightboxStatus === 'ready') {
          pswp()
        } else {
          window.addEventListener('lightbox:ready', pswp);
        }
      </script>
      








    
  </div>
</div>


  <script>
    console.log(String.raw`%c 
 ______     ______     __     __    __     __  __    
/\  == \   /\  ___\   /\ \   /\ "-./  \   /\ \/\ \   
\ \  __<   \ \  __\   \ \ \  \ \ \-./\ \  \ \ \_\ \  
 \ \_\ \_\  \ \_____\  \ \_\  \ \_\ \ \_\  \ \_____\ 
  \/_/ /_/   \/_____/   \/_/   \/_/  \/_/   \/_____/ 
                                                  
`,'color: #ff5252;')
    console.log('%c Theme.Reimu v' + '1.3.0' + ' %c https://github.com/D-Sketon/hexo-theme-reimu ', 'color: white; background: #ff5252; padding:5px 0;', 'padding:4px;border:1px solid #ff5252;')
  </script>
  





<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.getRegistrations().then((registrations) => {
      for (let registration of registrations) {
        registration.unregister();
      }
    });
  }
</script>



  
    
<script src="https://npm.webcache.cn/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm&#x2F;Yr2r3Dy4lfFg" crossorigin="anonymous" defer data-pjax></script>

    
<script src="https://npm.webcache.cn/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb&#x2F;GhzOouOXtZMP&#x2F;7XUzwPTstBeZFe&#x2F;+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" defer onload="renderMathInElement(document.body, {delimiters: [{left: &#39;$$&#39;, right: &#39;$$&#39;, display: true},{left: &#39;$&#39;, right: &#39;$&#39;, display: false}]});" data-pjax></script>

  





  </body>
  </html>

